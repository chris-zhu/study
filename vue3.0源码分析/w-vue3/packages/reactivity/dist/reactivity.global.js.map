{"version":3,"file":"reactivity.global.js","sources":["../../shared/src/index.ts","../src/effect.ts","../src/baseHandlers.ts","../src/reactive.ts","../src/ref.ts","../src/computed.ts"],"sourcesContent":["export const isArray = Array.isArray\r\nexport const isDate = (val: unknown): val is Date => val instanceof Date\r\nexport const isFunction = (val: unknown): val is Function =>\r\n  typeof val === 'function'\r\nexport const isString = (val: unknown): val is string => typeof val === 'string'\r\nexport const isSymbol = (val: unknown): val is symbol => typeof val === 'symbol'\r\nexport const isObject = (val: unknown): val is Record<any, any> =>\r\n  val !== null && typeof val === 'object'\r\nexport const extend = Object.assign\r\n\r\nexport const isIntegerKey = (key: unknown) =>\r\n  isString(key) &&\r\n  key !== 'NaN' &&\r\n  key[0] !== '-' &&\r\n  '' + parseInt(key, 10) === key\r\n\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\nexport const hasOwn = (\r\n  val: object,\r\n  key: string | symbol\r\n): key is keyof typeof val => hasOwnProperty.call(val, key)\r\n\r\nexport const hasChanged = (value: any, oldValue: any): boolean =>\r\n  value !== oldValue && (value === value || oldValue === oldValue)\r\n\r\nexport const isMap = (val: unknown): val is Map<any, any> =>\r\n  toTypeString(val) === '[object Map]'\r\nexport const isSet = (val: unknown): val is Set<any> =>\r\n  toTypeString(val) === '[object Set]'\r\nexport const toTypeString = (value: unknown): string =>\r\n  objectToString.call(value)\r\nexport const objectToString = Object.prototype.toString","import { isArray, isIntegerKey, isMap } from \"@vue/shared/src\"\r\nimport { TriggerOpTypes } from \"./operations\"\r\n\r\n\r\nexport const ITERATE_KEY = Symbol('iterate')\r\nexport const MAP_KEY_ITERATE_KEY = Symbol('Map key iterate')\r\n\r\nexport function effect(fn, options: any = {}) {\r\n  const effect = createReactiveEffect(fn, options)\r\n  if (!options.lazy) {\r\n    effect()\r\n  }\r\n  return effect\r\n}\r\n\r\nlet uid = 0\r\nconst effectStack = []\r\nlet activeEffect // 当前的effect\r\n\r\nfunction createReactiveEffect(fn, options) {\r\n  const effect = function () {\r\n    if (!effectStack.includes(effect)) {\r\n      /**\r\n       * effect(()=>{\r\n       *    console.log(state.a)  -->  effect1\r\n       *    effect(()=>{\r\n       *      console.log(state.b) -->  effect2\r\n       *    })\r\n       *    console.log(state.c)  -->  这里必须保证当前effect为effect1 ，所以要出栈   effectStack.pop()\r\n       * })\r\n       * \r\n       * */\r\n      try {\r\n        effectStack.push(effect)\r\n        activeEffect = effect\r\n        return fn()\r\n      } finally {\r\n        effectStack.pop()\r\n        activeEffect = effectStack[effectStack.length - 1]\r\n      }\r\n    }\r\n  }\r\n  effect.id = uid++\r\n  effect.allowRecurse = !!options.allowRecurse\r\n  effect._isEffect = true\r\n  effect.active = true\r\n  effect.raw = fn\r\n  effect.deps = []\r\n  effect.options = options\r\n\r\n  return effect\r\n}\r\n\r\nconst targetMap = new WeakMap()\r\n/**\r\n * targetMap:  {\r\n *   key: ['target'] :  Map: [key: 'key' : Set() ]\r\n * }\r\n */\r\nexport function track(target, type, key) {\r\n  if (activeEffect === undefined) {\r\n    return\r\n  }\r\n  let depsMap = targetMap.get(target)\r\n  if (!depsMap) {\r\n    targetMap.set(target, (depsMap = new Map()))\r\n  }\r\n  let dep = depsMap.get(key)\r\n  if (!dep) {\r\n    depsMap.set(key, (dep = new Set()))\r\n  }\r\n  if (!dep.has(activeEffect)) {\r\n    dep.add(activeEffect)\r\n    activeEffect.deps.push(dep)\r\n  }\r\n  console.log(targetMap);\r\n  \r\n}\r\n\r\nexport function trigger(target, type, key?, newValue?, oldvalue?) {\r\n  const depsMap = targetMap.get(target)\r\n  // console.log(depsMap);\r\n  \r\n  if (!depsMap) return\r\n\r\n  const effects = new Set() // 将所有的 effect 存入一个集合中  会自动去重\r\n\r\n  /** 将set里面的收集effect添加到effects中 */\r\n  const add = (effectsToAdd: Set<any>) => {\r\n    if (effectsToAdd) {\r\n      effectsToAdd.forEach(effect => {\r\n        if (effect !== activeEffect || effect.allowRecurse) {\r\n          effects.add(effect)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  // 修改的是数组的长度\r\n  if (key === 'length' && isArray(target)) {\r\n    // 如果对应的长度有依赖， 则需要收集依赖\r\n    depsMap.forEach((dep, key) => {\r\n      if (key === 'length' || key >= newValue) {\r\n        // 如果更改的长度小于收集的索引，那么这个索引也需要触发effect重新执行\r\n        add(dep)\r\n      }\r\n    })\r\n  } else {\r\n    // 可能是对象\r\n    if (key !== undefined) { // 这里肯定是修改   \r\n      add(depsMap.get(key)) // 不可能是添加  添加 depsMap.get(key) 返回是个undefined  因为还没有收集依赖\r\n    }\r\n\r\n    switch (type) {\r\n      case TriggerOpTypes.ADD:\r\n        if (!isArray(target)) {\r\n          add(depsMap.get(ITERATE_KEY))\r\n          if (isMap(target)) {\r\n            add(depsMap.get(MAP_KEY_ITERATE_KEY))\r\n          }\r\n        } else if (isIntegerKey(key)) {\r\n          // 添加了一个索引  触发长度更新\r\n          // new index added to array -> length changes\r\n          add(depsMap.get('length'))\r\n        }\r\n        break\r\n      case TriggerOpTypes.DELETE:\r\n        if (!isArray(target)) {\r\n          add(depsMap.get(ITERATE_KEY))\r\n          if (isMap(target)) {\r\n            add(depsMap.get(MAP_KEY_ITERATE_KEY))\r\n          }\r\n        }\r\n        break\r\n      case TriggerOpTypes.SET:\r\n        if (isMap(target)) {\r\n          add(depsMap.get(ITERATE_KEY))\r\n        }\r\n        break\r\n    }\r\n\r\n  }\r\n\r\n  const run = (effect: any) => {\r\n    if (effect.options.scheduler) {\r\n      effect.options.scheduler(effect)\r\n    } else {\r\n      effect()\r\n    }\r\n  }\r\n\r\n  effects.forEach(run)\r\n\r\n}","import { extend, hasChanged, hasOwn, isArray, isIntegerKey, isObject } from \"@vue/shared/src\"\r\nimport { track, trigger } from \"./effect\"\r\nimport { TrackOpTypes, TriggerOpTypes } from \"./operations\"\r\nimport { reactive, readonly } from \"./reactive\"\r\n\r\nconst get = createGetter()\r\nconst shallowGet = createGetter(false, true)\r\nconst readonlyGet = createGetter(true)\r\nconst shallowReadonlyGet = createGetter(true, true)\r\n\r\nconst set = createSetter()\r\nconst shallowSet = createSetter(true)\r\n\r\n\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n  return function get(target, key, receiver) {\r\n    const res = Reflect.get(target, key, receiver)\r\n\r\n    if (!isReadonly) { // 不是只读的，要开始收集依赖\r\n      track(target, TrackOpTypes.GET, key)\r\n    }\r\n\r\n    if (shallow) { // 如果是shallow 则返回res\r\n      return res\r\n    }\r\n\r\n    if (isObject(res)) { // 如果是对象，则递归代理，  其实是一个懒代理， 只有当取值的时候才会循环代理\r\n      return isReadonly ? readonly(res) : reactive(res)\r\n    }\r\n\r\n    return res\r\n  }\r\n}\r\n\r\nfunction createSetter(shallow = false) {\r\n  return function set(target, key, value, receiver) {\r\n\r\n    const oldValue = target[key]\r\n    const hadKey =\r\n      isArray(target) && isIntegerKey(key)\r\n        ? Number(key) < target.length\r\n        : hasOwn(target, key)\r\n    const result = Reflect.set(target, key, value, receiver)\r\n\r\n    if (!hadKey) { // 新增\r\n      trigger(target, TriggerOpTypes.ADD, key, value)\r\n    } else if (hasChanged(value, oldValue)) { // 修改\r\n      trigger(target, TriggerOpTypes.SET, key, value, oldValue)\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n\r\nexport const mutableHandlers = {\r\n  get,\r\n  set\r\n}\r\n\r\nexport const readonlyHandlers = {\r\n  get: readonlyGet,\r\n  set(target, key) {\r\n    console.warn(\r\n      `Set operation on key \"${String(key)}\" failed: target is readonly.`,\r\n      target\r\n    )\r\n    return true\r\n  },\r\n}\r\n\r\nexport const shallowReactiveHandlers = extend(\r\n  {},\r\n  mutableHandlers,\r\n  {\r\n    get: shallowGet,\r\n    set: shallowSet\r\n  })\r\n\r\nexport const shallowReadonlyHandlers = extend(\r\n  {},\r\n  readonlyHandlers,\r\n  {\r\n    get: shallowReadonlyGet,\r\n  }\r\n)","import {\r\n  mutableHandlers,\r\n  readonlyHandlers,\r\n  shallowReactiveHandlers,\r\n  shallowReadonlyHandlers\r\n} from './baseHandlers'\r\nimport { isObject } from '@vue/shared'\r\n\r\nexport const enum ReactiveFlags {\r\n  SKIP = '__v_skip',\r\n  IS_REACTIVE = '__v_isReactive',\r\n  IS_READONLY = '__v_isReadonly',\r\n  RAW = '__v_raw'\r\n}\r\n\r\nexport interface Target {\r\n  [ReactiveFlags.SKIP]?: boolean\r\n  [ReactiveFlags.IS_REACTIVE]?: boolean\r\n  [ReactiveFlags.IS_READONLY]?: boolean\r\n  [ReactiveFlags.RAW]?: any\r\n}\r\n\r\nexport const reactiveMap = new WeakMap()\r\nexport const readonlyMap = new WeakMap()\r\n\r\nexport function reactive(target: object) {\r\n  return createReactiveObject(target, false, mutableHandlers)\r\n}\r\nexport function shallowReactive(target: object) {\r\n  return createReactiveObject(target, false, shallowReactiveHandlers)\r\n}\r\nexport function readonly(target: object) {\r\n  return createReactiveObject(target, true, readonlyHandlers)\r\n}\r\nexport function shallowReadonly(target: object) {\r\n  return createReactiveObject(target, true, shallowReadonlyHandlers)\r\n}\r\n\r\n\r\n\r\nfunction createReactiveObject(target, isReadonly, baseHandlers) {\r\n  if (!isObject(target)) return target\r\n\r\n  const proxyMap = isReadonly ? readonlyMap : reactiveMap\r\n  const exisitProxy = proxyMap.get(target)\r\n  // 如果target被代理过了， 返回该代理\r\n  if (exisitProxy) return exisitProxy\r\n\r\n  const proxy = new Proxy(target, baseHandlers)\r\n  // 放入Map映射中\r\n  proxyMap.set(target, proxy)\r\n  return proxy\r\n\r\n}\r\n\r\n// export function isReactive(value) {\r\n//   if()\r\n// }\r\nexport function isReadonly(value) {\r\n  return !!(value && (value as Target)[ReactiveFlags.IS_READONLY])  \r\n}\r\n\r\n\r\n// export function isReactive(value: unknown): boolean {\r\n//   if (isReadonly(value)) {\r\n//     return isReactive((value as Target)[ReactiveFlags.RAW])\r\n//   }\r\n//   return !!(value && (value as Target)[ReactiveFlags.IS_REACTIVE])\r\n// }\r\n\r\n// export function isReadonly(value: unknown): boolean {\r\n//   return !!(value && (value as Target)[ReactiveFlags.IS_READONLY])\r\n// }\r\n\r\n// export function isProxy(value: unknown): boolean {\r\n//   return isReactive(value) || isReadonly(value)\r\n// }","import { hasChanged, isArray, isObject } from \"@vue/shared/src\"\r\nimport { reactive } from \"./reactive\"\r\nimport { track, trigger } from \"./effect\"\r\nimport { TrackOpTypes, TriggerOpTypes } from \"./operations\"\r\n\r\n\r\n\r\nexport function ref(value) {\r\n  return createRef(value)\r\n}\r\n\r\n\r\nclass RefImpl {\r\n  private _value: any\r\n  public readonly __v_isRef = true\r\n  constructor(private _rawValue, public readonly _shallow = false) {\r\n    this._value = _shallow ? _rawValue : convert(_rawValue)\r\n  }\r\n\r\n  get value() {\r\n    track(this, TrackOpTypes.GET, 'value')\r\n    return this._value\r\n  }\r\n\r\n  set value(newValue) {\r\n    if (hasChanged(newValue, this._rawValue)) {\r\n      this._rawValue = newValue\r\n      this._value = this._shallow ? newValue : convert(newValue)\r\n      trigger(this, TriggerOpTypes.SET, 'value', newValue)\r\n    }\r\n  }\r\n}\r\nclass ObjectRefImpl {\r\n  public readonly __v_isRef = true\r\n  constructor(private readonly _object, private readonly _key) { }\r\n  get value() {\r\n    return this._object[this._key]\r\n  }\r\n  set value(newVal) {\r\n    this._object[this._key] = newVal\r\n  }\r\n}\r\n\r\nfunction createRef(rawValue, shallow = false) {\r\n  if (isRef(rawValue)) return rawValue\r\n  return new RefImpl(rawValue, shallow)\r\n}\r\n\r\nfunction isRef(r) {\r\n  return Boolean(r && r.__v_isRef === true)\r\n}\r\n\r\nconst convert = <T extends unknown>(val: T): T =>\r\n  isObject(val) ? reactive(val as any) : val\r\n\r\n\r\nexport function toRef(object, key) {\r\n  return isRef(object[key])\r\n    ? object[key]\r\n    : (new ObjectRefImpl(object, key) as any)\r\n}\r\n\r\nexport function toRefs(object) {\r\n  const ret = isArray(object) ? new Array(object.length) : {}\r\n  for (const key in object) {\r\n    ret[key] = toRef(object, key)\r\n  }\r\n  return ret\r\n}","import { isFunction } from \"@vue/shared/src\"\r\nimport { effect, track, trigger } from \"./effect\"\r\nimport { TrackOpTypes, TriggerOpTypes } from \"./operations\";\r\n\r\n\r\nconst NOOP = () => { }\r\n\r\nclass ComputedRefImpl {\r\n  public readonly effect\r\n  private _dirty = true\r\n  public readonly __v_isRef = true;\r\n  private _value\r\n\r\n\r\n  constructor(getter, private readonly setter, isReadonly) {\r\n    this.effect = effect(getter, {\r\n      lazy: true,\r\n      scheduler: () => { // 错误点： 这里必须用箭头函数，绑定this到当前实例\r\n        if (!this._dirty) {\r\n          this._dirty = true\r\n          trigger(this, TriggerOpTypes.SET, 'value')\r\n        }\r\n      }\r\n    })\r\n    this['__v_isReadonly'] = isReadonly\r\n  }\r\n\r\n  public get value() {\r\n    if (this._dirty) {\r\n      this._value = this.effect()\r\n      this._dirty = false\r\n    }\r\n    track(this, TrackOpTypes.GET, 'value')\r\n    return this._value\r\n  }\r\n\r\n  public set value(newVal) {\r\n    this.setter(newVal)\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\nexport function computed(getterOrOptions) {\r\n  let getter\r\n  let setter\r\n  if (isFunction(getterOrOptions)) {\r\n    getter = getterOrOptions\r\n    setter = NOOP\r\n  } else {\r\n    getter = getterOrOptions.get\r\n    setter = getterOrOptions.set\r\n  }\r\n\r\n  return new ComputedRefImpl(getter, setter, isFunction(getterOrOptions) || !getterOrOptions.set)\r\n}"],"names":[],"mappings":"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"}